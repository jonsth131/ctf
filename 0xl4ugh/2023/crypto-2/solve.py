import itertools
from gmpy2 import root
from functools import reduce
from binascii import unhexlify
import gmpy2
gmpy2.get_context().precision = 4096


def chinese_remainder_theorem(items):
    # Determine N, the product of all n_i
    N = 1
    for a, n in items:
        N *= n

    # Find the solution (mod N)
    result = 0
    for a, n in items:
        m = N // n
        r, s, d = extended_gcd(n, m)
        if d != 1:
            raise "Input not pairwise co-prime"
        result += a * s * m

    # Make sure we return the canonical solution.
    return result % N


def extended_gcd(a, b):
    x, y = 0, 1
    lastx, lasty = 1, 0

    while b:
        a, (q, b) = b, divmod(a, b)
        x, lastx = lastx - q * x, x
        y, lasty = lasty - q * y, y

    return (lastx, lasty, a)


def mul_inv(a, b):
    b0 = b
    x0, x1 = 0, 1
    if b == 1:
        return 1
    while a > 1:
        q = a // b
        a, b = b, a % b
        x0, x1 = x1 - q * x0, x0
    if x1 < 0:
        x1 += b0
    return x1


ciphertexts = [527715545190279160683427564102415343921040361668522479441727171363460126920288425567651662947621100428078618585624707291232885706132068328305084115992340337032439274527186826778447854890982475878955397378947713414201050357209397140391734937299379698886378260075489810871914081834819238233619226377140629000968272406078503709732856007314599153696811725183993977424740513321277346005097500256459835713834182894305536107589525724571208098322359262186595358977825573193007799376102473240254372327730839223120373818874006086733633525830272119104666835113980722223258389364156995110666626033474727892354233040278510447646,
               1472597759129365656923104517786018785463000417461208498747767681614622931143713506180408298711548768256076735841250645395148318999907204184797999781993542823553379076045885747249470083585262303876508350357386704923618083112313906682411590303090060951209969182124559027961502332722782273839397738218185482810854057706263165523258364210304422689413684031088755496295428935904402887802530419816148533562641459322119192583081369942409689225395814814486040495974220422308958793247428171229633175226130994831375743926392202331961241151983855387989797919442441405155933755408271294662201919819573515689116193765682455815293,
               19687787542408825353862365941166693780495735526080597950942512596342012719844332446375662818656129817958447465480112761159920010606627715065386255863198334333497368403219426139905490192996134971285585696876327971712760992836616327000048663087721602131345160396805979063857247553762311382660817510648279603943403786836841376228752952281654415470248375714142035127836932814880354124329124254053896093484364330033376422200500596242679870767853279820750716616442898088737959707389636718810620360018351774057172147955404228743619986931115982963488083795297318650566624253771324672427156391407659070037676643186171848723622,
               10744930117286495305963467518329822887727938450962133478316344155163149989437943485064704514384301866092903230654325902279494326857544873979884714551997958580626424160749709500244237559274064518059486266174092420102153843000449105050062494602615949393975529616272195653605020612706326783671550448582201207509192404177195305259579274719878634163755678019172064653667228312988482518695849474970561259066709201289831867716062303482833933866643505884543714714005066192460458588423464254166214302216068955262632054029853779884937799630094694372311924871291028689362061442153334699542031142986398336478061400405069026337106,
               20361098259921779858250680654300305573293744686472180315003946766479767408747790370183875011809316908803668411735295711855925871859691520641486248130384001080851360212718843881606575510846689753596386936731125364872453625364185534674093110200164313925842506415523754221276868435263222106188454080305768887962724868927019192740857219732205604031455857236132231658124912171436870792886133701002438292335747934182464172451510622149039963613471041552910348930220793673295311717053710708074567062262743077069005375269946770814282459013538249812978766317941955130106047695528682268975340400593027417316992882052338198037466,
               27649448028819385827054378757034068229235081687699302077249433330318857006353729221577227673700129409781575153915029805721345803096479482991366417433006584527963465749469846556111531406000404013517979458250398400420044292160319950915543151148509807317740057108508011027857518694401025114827130166359539062682725087628188250270775677253707800849102224559474541450487055353192809366466722855297149964549750207017133070381586087659267136022952139516920259073514476716985169080214111723054452323539431977306540498901482817708558645705729475773533434907199042717123065257030381637782893161940927590697536806827841651779387,
               3588834914068244764978847528974911801802821398212169750672865884700542368991450049690083767693574690291830294950850358083731734871434722961357050353338816558228321379393810196601208544336225234475607493833411321251432487272759590316027031929295147856977078635069913959980718727852269666506892828318703855667834381682850036025194399651311175026103780053445192748023837898942732832706062537603826652218073852576250390343647520968940254331194161935299426193818638418721284966398267306383304242608620850579484352009756188229073120890712704352931453094400334621612077142890162609058353173155265125372299438387828663173969,
               10229147187118959140330333391239865681664276481587129879440042698341458039597166927342722479452432264226668185734769042655595351058697184883327518458542322749953868234243466086093317029173149410523000437749248718526113498066642869945046385656479299362605334898582267420173383536624033857730762359865105387204804926874876525174741595502158778000040884907506168958835280654934927062226142641489895844756519492191048740814274015832976597628227035385189246346283157393413348202301165735554747305612171742974088292391836311958140278634173990406517389030154001891032339182630252269017868315041644609560596994636935235386286,
               15708239210094387579199089536767511550888048027490010164185901955109535966671900311536125726983084530293748734312560167355076193018840655506254166727738835219686283462437409126207010086535792191015250959520513416110435882072217275910723527526910784791632514795252752105798439749483233988502250280544589640220591356301902711686149502327005710345033535149987603657469992028852748811338457873938370726981869334530243639208850573157034465804927026310478063385847652029389674600852564331755919605353765535891376165602170685727287766488274177731597843490997365305474109610016275153061868217674119125108614112515325260355346,
               3389354591738964969299303937363115331907608931026722558883400932073116647976663004603317551694115369344441207427517615517885211374167420598817324431073177021611079202809474363675591470172714367944871252456726304758680342873484425929393035032073104901044022680167584941314121514144863149523478309297412600688532602943059116071529052462023434472014219696500583577197022411742500051464078226845236129447478243871249529569520994697197643745345736477047647893244196978548979608367399628989164683988988313468747995298533881358949762964152094232057206734685698269301160315534292242856312132889711635974073698887194701023079,
               14434750843408128208054007396234672618708611782981523058288089804492142096719907747972431549220092217972240981069377132360980117752477707407919206755340844679803649891464544100128919530276076456194240102078081004328976269239571643194854827613716883776108583329683652579413130866195333731317794133113161990546629791167056055593791731130793254120658260116698113455288450543424163771196527094640624320235122755542810719146776517220281059673374152678894606618394273429437246865489045074003201588976413422220165499098427115329137344219388858456660857616081561470942173409321694835341103593334097698580754666079044200230782
               ]

moduli = [16691865792147194697602300512532851182049374635648801189035809706515463120586646192481229145243032049569188562652509317620313234450062651687702398851985141210252080200118496555573100538082230667123330012596663673730204381449416210246747100065137562877723883087453655498192797717322414163929033958154847172474876805828355467779563924126108244847992313964795565023554963296215243179420547862638306573737884301209065640499511319512400331964327680966267406302192650421152395257843371809022919488155958420254813754963104236903270765037373600427365083337259089056941701762267110792581437924801009323096077817633370816094073,
          13952511627538481416065859327302605996666492319333560542683072763078965416642924911031806393308099485676787331210718749062351170859482246730052180688165858467663545887929916675864767103610167019515147412199427865985735427908829412412763048038901222685492020760929329628710146975075916400644583611308150321829686155020563822601999509532799266918752868773279981464830048821506358226572596264518918480278645733685466844998656226814063372972733726809252108671621770131892323141347811613680468790803221967756781859858788752701290676062511579012755465924413948535613957190804082606730664709069435378700755072204823832782847,
          23829005823394681794462487610417605182941932027444701521372146064646751285920937839819532126749219321469179720706416105851262366031103327159439355014361872372290552571027320087594733822765671482993266834338568213461972161606225369794507568492469392035390970065529856446060276806677562379652496761421599530403901276705158778586459470229555886579028470462236534467220725780625477167031673749134233363691590266739592109447607052698930775058273509452504220579587218827174556670845696682215012417581045198879052684755330300376930295889177723446309278796445417412898961133271797985151728020165748959341894831717818114917001,
          20646717121789407901634226024961685518036399692731171785439808659780841141665010174316324712421438885298627535757259921633396239149109468030916849210612777571340986427600609249046635046990511667058217021206834442619939565210447336330859414037049990953484317913613427569371911236789584763338774360533111447852911511975753177067533031870331511491253575943486931841442186487727551431083228780015029438556821324597356562287041838613388591129356823076461594088885255531142263515248970174779362006133046618931502955419559159467473282225269138846859300521679944898396074546318591675892663073594137250646856370395684088947337,
          22063733794270027489580076070655451951666205444920988031794963020140370218190109238063756147090572431283821798325769878463088534873146392528463528722322072297007980327323689261027539896183700546799598376887234042269724443921730023658121401530869154090781331883356252623911525894409346783174833049800567232165918803994928528959307421790659801504831252599506938608139855086358818707133340506220266668092431286624495493607464556939715160914123238867029329259967079639842448264252557257732639844167708589920867264442825716828413166091277629994959480034560502001942921668389554716890039752136339979684157311004190112457981,
          31674990142398817349342335952785682853223736156686290222874054969053374160483207475442320119636606261920895106555374926547192641424716711903849566344966456896362196699534070803517570367301485450643007262030694799775768383110400421563464355230582215217443700041109792060584625387175250551651652467190685375321831829690640599113766488762562974806548669089940069336092057559479742902200354450719357510748683676513242013718072360815470067586951589901828049783220168723968319808838321028990247089309345686347800386220169020062613936543088334931946861372808120616236935569366831398287496071993652558225061071866596005174339,
          23759135653331483300215617560199926809446754885877995950941597516628853091765785991835977470261133090329513286706505797250885846737850701803613969056650288635933731983397554779822837484347518010989510013354604018173051109079876961329303922301101037535119093700071077591448702207716490956680147045197082132141287766137970530203730771171755160897908261631371901360624603504480550229102337292820709005022108231930740936225998929550417057229101561443805886738192983948060345453415146637371247891031834650611590374052626562953508046144393383221271325896172392768079982543485607564691338586637941520598459184470615657091859,
          14624688252976369064197902392851869350097384089830034394593389162158452527706442511843096831082278186704331957470065490706550749096609689161635587909032045710308067456231448223569310715892863643910528862618298594939194954392854970686201086804077620265420853276296039941732806830869144102780978011442866504956331791621140374997937226873016308098634434320220488606268381500742380744479357929114809777487539685717497892165322181930040577529089849176375606611596444773456638977482509857593215963111768785797483677822957519185606966180976766261716978247396701539382451642927998062119546950381631131511995168557703362070771,
          18665663064204668407416346303063362404749458442046934222496425916240630282777729708068347125697306821835206267821480218831590701256792237491525513061816936762613021899632419044441192879712229913681610222811930015593726016337727758756355546949127315098759974079585888072113447365103545201209432462512705370987093427827598834565889599090293017241475451405534356845700723316058373786917699206247681601472368948714840549565201176329445567380038634364625531058592706818783435683424370997689779378535027259782297383464869688186727876706110488209686132273036200831221236533729686258914659841342865051937919259758962898964509,
          13304831808410484025618506539578794705557850345314322636817374135535418423832953239212193712130952602979929930070168737717561928365529801940746903833679236193239957098153686926058406828357691845146650871893420207706019225859995939325380984698902296860345053345645345072505217126899340101985829364184437896453925702182442122153245455287884661427291347290343846838354518540014004592800860984406489723574493973104999705704381642886559306052693517793257239091537634940069085851043718351193047839219522054579989428942268967963139796145529067370526896943481636036784305079667911243712939408725012535463822736124201292610263,
          15738628325645101557334363920326098362103699260823650330180721553048914517423909626264860472827308744542186287272405997127238987097754247661201282345445530733205144683783994658669974471135844798540308080594182119013222092838365688851020091445193301391226252696936783804038196661761636728227231563019996114106104386063408100167802301671574582625198534583638809719972220132858282730598442647908545099265761555842709206013281569103359684450245951631055515358969906908953752706121720496086474614533005374829631163793876615598311141206497114185814609858234471070064856199505321016933201980899007413151417616303712583218343
          ]

indices = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

for a,b,c in list(itertools.combinations(indices, 3)):
    cts = [ciphertexts[a], ciphertexts[b], ciphertexts[c]]

    mdi = [moduli[a], moduli[b], moduli[c]]

    C = chinese_remainder_theorem([(cts[0], mdi[0]), (cts[1], mdi[1]), (cts[2], mdi[2])])
    M = int(root(C, 3))

    M = hex(M)[2:]
    try:
        print(unhexlify(M).decode('utf-8'))
        break
    except:
        continue
